{% extends "base.html" %}
{% block title %}Главная{% endblock %}
{% block header %}Главная{% endblock %}

{% block content %}
<div style="width: 100%;">
    <div class="forum-header">
        Добро пожаловать на Oldware
    </div>

    <div class="user-panel">
        {% if current_user.is_authenticated %}
        <div class="user-info">
            <div class="user-avatar">{{ current_user.username[0] }}</div>
            <div>
                <div>{{ current_user.username }}</div>
                <div>Вы авторизованы</div>
            </div>
        </div>
        <div>
            <a href="{{ url_for('logout') }}" class="button">Выход</a>
        </div>
        {% else %}
        <div class="user-info">
            <div class="user-avatar">Г</div>
            <div>
                <div>Гость</div>
                <div>Вы не авторизованы</div>
            </div>
        </div>
        <div>
            <a href="{{ url_for('login') }}" class="button">Вход</a>
            <a href="{{ url_for('register') }}" class="button">Регистрация</a>
        </div>
        {% endif %}
    </div>

    <div class="forum-categories">
        {% for category in categories %}
        <div class="category">{{ category.name }}</div>
        
        {% for forum in category.forums %}
        <div class="forum">
            <div class="forum-icon"><img src="{{ url_for('static', filename='icons/forum.png') }}" alt="forum"></div>
            <div class="forum-info">
                <a href="{{ url_for('forum', forum_id=forum.id) }}">
                    <div class="forum-name">{{ forum.name }}</div>
                </a>
                <div class="forum-description">{{ forum.description }}</div>
            </div>
            <div class="forum-stats">
                <div>Тем: {{ forum.topics|length }}</div>
                <div>Сообщений: {{ forum.posts_count() }}</div>
            </div>
        </div>
        {% endfor %}
        {% endfor %}
    </div>

    <div style="text-align: right; margin-top: 10px;">
    {% if user.is_authenticated %}
        <button class="button" onclick="location.href='{% url 'new_topic' forum_id=1 %}'">Новая тема</button>
    {% endif %}
    </div>
</div>
{% endblock %}